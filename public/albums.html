<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Álbum</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <nav>
            <div class="logo">Teste de Software</div>
            <div class="nav-links">
                <a href="/posts" class="nav-link">Post</a>
                <a href="/albums" class="nav-link active">Album</a>
                <a href="/todos" class="nav-link">Todos</a>
                <a href="#" class="nav-link">Comments</a>
                <a href="/index" class="nav-link logout">Log-out</a>
            </div>
        </nav>
    </header>

    <main>
        <div class="form-container">
            <h1 class="title">CADASTRAR ÁLBUM</h1>
            <p class="subtitle">Crie o seu novo álbum</p>

            <form id="album-form" class="form-content">
                <div class="form-group">
                    <input type="text" id="title" name="title" placeholder="Título do Álbum" required class="input-field">
                </div>
                <div class="button-container">
                    <button type="submit" class="btn-submit">CRIAR</button>
                </div>
            </form>
        </div>

        <div class="form-container" style="margin-top: 40px;">
            <h2 class="title" style="font-size: 2rem;">Álbuns Carregados</h2>
            <ul id="album-list" class="album-list-container">
                </ul>
        </div>
    </main>

    <script>
        const API_URL = 'http://localhost:3000/api/albums';

        // Função para carregar álbuns (GET)
        async function carregarAlbuns() {
            const lista = document.getElementById('album-list');
            try {
                const response = await fetch(API_URL);
                const albuns = await response.json();
                
                lista.innerHTML = '';
                if (albuns.length === 0) {
                    lista.innerHTML = '<li>Nenhum álbum encontrado.</li>';
                    return;
                }

                albuns.forEach(album => {
                    const item = document.createElement('li');
                    item.textContent = `ID: ${album.id} - Título: ${album.title}`;
                    lista.appendChild(item);
                });
            } catch (error) {
                console.error('Erro ao carregar:', error);
                lista.innerHTML = '<li>Erro ao carregar dados.</li>';
            }
        }

        // Função para criar álbum (POST)
        document.getElementById('album-form').addEventListener('submit', async (e) => {
            e.preventDefault(); // Impede o recarregamento da página
            const titleInput = document.getElementById('title');
            
            try {
                await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ title: titleInput.value })
                });
                
                titleInput.value = ''; // Limpa o campo
                carregarAlbuns(); // Recarrega a lista
            } catch (error) {
                console.error('Erro ao criar álbum:', error);
            }
        });

        // Carrega ao iniciar
        document.addEventListener('DOMContentLoaded', carregarAlbuns);
    </script>
</body>
</html>